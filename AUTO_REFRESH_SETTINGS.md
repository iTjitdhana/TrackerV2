# การตั้งค่า Auto Refresh สำหรับหน้า Tracker

## ภาพรวม

ฟีเจอร์ Auto Refresh Settings ช่วยให้ผู้ใช้สามารถควบคุมการอัปเดตข้อมูลอัตโนมัติในหน้า Tracker เพื่อป้องกันปัญหา HTTP 429 (Too Many Requests) และลดการใช้งานเซิร์ฟเวอร์

## ฟีเจอร์ที่เพิ่มเข้ามา

### 1. การตั้งค่า Auto Refresh ในหน้า Settings

- **ตำแหน่ง**: หน้า Settings > การตั้งค่า Auto Refresh
- **ฟังก์ชัน**: เปิด/ปิดการอัปเดตข้อมูลอัตโนมัติ
- **ค่าเริ่มต้น**: ปิดใช้งาน (false)

### 2. การแสดงสถานะในหน้า Tracker

- **มุมล่างขวา**: แสดงสถานะ Auto Refresh
- **สีไฟ**: 
  - เขียว = Auto Refresh เปิด
  - เทา = Auto Refresh ปิด
  - ส้ม = กำลังอัปเดต

### 3. ปุ่มรีเฟรชในหน้า Tracker

- **แสดงเมื่อ**: Auto Refresh ปิด
- **ตำแหน่ง**: ด้านขวาของปุ่มเปลี่ยนภาษา
- **ฟังก์ชัน**: รีเฟรชข้อมูลด้วยตนเอง

## การใช้งาน

### การเปิด/ปิด Auto Refresh

1. ไปที่หน้า **Settings**
2. เลื่อนลงไปที่ส่วน **การตั้งค่า Auto Refresh**
3. ใช้สวิตช์เพื่อเปิด/ปิด Auto Refresh
4. การตั้งค่าจะถูกบันทึกอัตโนมัติ

### เมื่อเปิด Auto Refresh

- ข้อมูลจะอัปเดตอัตโนมัติทุก 2 นาที
- แสดงสถานะการอัปเดตที่มุมล่างขวา
- ข้อมูลจะทันสมัยเสมอ

### เมื่อปิด Auto Refresh

- ลดการใช้งานเซิร์ฟเวอร์
- ป้องกันปัญหา HTTP 429
- ต้องกดปุ่มรีเฟรชเองเพื่ออัปเดตข้อมูล
- แสดงข้อความแนะนำให้ใช้ปุ่มรีเฟรชในตั้งค่า

## การจัดการ Rate Limiting

### การป้องกัน HTTP 429

1. **Rate Limiting**: ตรวจสอบว่าการ refresh ครั้งล่าสุดห่างกันอย่างน้อย 30 วินาที
2. **Backoff Strategy**: เมื่อเจอ HTTP 429 จะเพิ่มเวลารอเป็น 1 นาที
3. **Error Handling**: แสดงข้อความแจ้งเตือนที่เหมาะสม

### การปรับปรุงประสิทธิภาพ

- ลดความถี่การอัปเดตจากทุก 30 วินาที เป็นทุก 2 นาที
- เพิ่มการตรวจสอบสถานะก่อนอัปเดต
- ปรับปรุงการจัดการ Error

## API Endpoints

### ใหม่

- `GET /api/settings/auto-refresh` - ตรวจสอบการตั้งค่า Auto Refresh

### ที่มีอยู่

- `GET /api/settings` - โหลดการตั้งค่าทั้งหมด
- `PUT /api/settings` - บันทึกการตั้งค่า
- `POST /api/settings/refresh-tracker` - ส่งสัญญาณรีเฟรช

## การตั้งค่าเริ่มต้น

```json
{
  "autoRefreshEnabled": false,
  "syncModeEnabled": false
}
```

## ข้อแนะนำการใช้งาน

### สำหรับผู้ใช้ทั่วไป
- เปิด Auto Refresh เพื่อให้ข้อมูลทันสมัย
- หากเจอปัญหา HTTP 429 ให้ปิด Auto Refresh ชั่วคราว

### สำหรับผู้ดูแลระบบ
- ตรวจสอบการใช้งานเซิร์ฟเวอร์
- ปรับการตั้งค่า Rate Limiting ตามความเหมาะสม
- ติดตาม Log เพื่อดูการใช้งาน

## การแก้ไขปัญหา

### ปัญหาที่พบบ่อย

1. **HTTP 429 Error**
   - สาเหตุ: เรียก API บ่อยเกินไป
   - วิธีแก้: ปิด Auto Refresh หรือเพิ่มเวลารอ

2. **ข้อมูลไม่อัปเดต**
   - สาเหตุ: Auto Refresh ปิด
   - วิธีแก้: เปิด Auto Refresh หรือกดปุ่มรีเฟรช

3. **การตั้งค่าไม่บันทึก**
   - สาเหตุ: ปัญหาการเชื่อมต่อ
   - วิธีแก้: ตรวจสอบการเชื่อมต่อและลองใหม่

## การพัฒนาต่อ

### ฟีเจอร์ที่อาจเพิ่มในอนาคต

1. การตั้งค่าช่วงเวลาการอัปเดต (1-5 นาที)
2. การแจ้งเตือนเมื่อปิด Auto Refresh นาน
3. การบันทึกประวัติการอัปเดต
4. การตั้งค่าตามผู้ใช้

### การปรับปรุงประสิทธิภาพ

1. การใช้ WebSocket สำหรับ Real-time updates
2. การ Cache ข้อมูลใน Local Storage
3. การ Optimize การเรียก API
4. การเพิ่ม Progressive Loading
